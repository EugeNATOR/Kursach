<Window x:Class="MeteoStation.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Метеостанция - сбор данных" Height="500" Width="700"
        WindowStartupLocation="CenterScreen">
    <Grid x:Name="BackgroundGrid" Background="#f0f0f0">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="3*"/>
            <ColumnDefinition Width="32*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Подключенные устройства -->
        <Border x:Name="ConnectDevice" Grid.Row="0" Background="White" Margin="10,10,10,5" Padding="15" BorderThickness="0,0,0,1" BorderBrush="#e0e0e0" Grid.ColumnSpan="2">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <TextBlock x:Name="ConnectText" Grid.Column="0" Text="Подключенные устройства" FontWeight="Bold" VerticalAlignment="Center"/>

                <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                    <ComboBox x:Name="DeviceComboBox" Width="150" Margin="5,0" Padding="5"
                              ItemsSource="{Binding AvailableDevices}" DisplayMemberPath="Name"/>
                    <Button x:Name="ConnectBtn" Content="Подключить" Click="ConnectBtn_Click" 
                            Margin="5,0" Padding="15,5" Background="#0078d4" Foreground="White" BorderThickness="0"/>
                    <Button x:Name="DisconnectBtn" Content="Отключить" Click="DisconnectBtn_Click" 
                            Margin="5,0" Padding="15,5" Background="#d13438" Foreground="White" BorderThickness="0"/>
                    <TextBlock x:Name="StatusText" Text="Не подключено" VerticalAlignment="Center" 
                               Margin="10,0,0,0" Foreground="#666" FontStyle="Italic"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Текущие показания -->
        <Border x:Name="Measure" Grid.Row="1" Background="White" Margin="10,5,10,5" Padding="15" Grid.ColumnSpan="2">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Температура -->
                <StackPanel Grid.Column="0" Orientation="Vertical" HorizontalAlignment="Center">
                    <TextBlock x:Name="Temperature" Text="Температура" FontSize="14" Foreground="#666" HorizontalAlignment="Center"/>
                    <TextBlock x:Name="TemperatureText" Text="0 °C" FontSize="24" FontWeight="Bold" 
                               HorizontalAlignment="Center" Margin="0,5,0,0"/>
                </StackPanel>

                <!-- Влажность -->
                <StackPanel Grid.Column="1" Orientation="Vertical" HorizontalAlignment="Center">
                    <TextBlock x:Name="Humidity" Text="Влажность" FontSize="14" Foreground="#666" HorizontalAlignment="Center"/>
                    <TextBlock x:Name="HumidityText" Text="0 %" FontSize="24" FontWeight="Bold" 
                               HorizontalAlignment="Center" Margin="0,5,0,0"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Таблица изменений -->
        <Border x:Name="BackgroundTable" Grid.Row="2" Background="White" Margin="10,5,10,5" Padding="15" Grid.ColumnSpan="2">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <TextBlock x:Name="TableName" Grid.Row="0" Text="Таблица изменений" FontWeight="Bold" Margin="0,0,0,10"/>

                <DataGrid Grid.Row="1" x:Name="DataGrid" AutoGenerateColumns="False" 
                         HeadersVisibility="Column" BorderThickness="1" BorderBrush="#e0e0e0">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Дата и время" Binding="{Binding Time, StringFormat='dd.MM.yyyy HH:mm:ss'}" Width="*"/>
                        <DataGridTextColumn Header="Температура (°C)" Binding="{Binding Temperature}" Width="*"/>
                        <DataGridTextColumn Header="Влажность (%)" Binding="{Binding Humidity}" Width="*"/>
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
        </Border>

        <!-- Панель управления и индикаторы -->
        <Border x:Name="Indicators" Grid.Row="3" Background="White" Margin="10,5,10,10" Padding="15" Grid.ColumnSpan="2">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Кнопки управления -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" HorizontalAlignment="Center">
                    <Button Content="Считать данные" Click="ReadDataBtn_Click" 
                            Margin="5" Padding="15,8" Background="#107c10" Foreground="White" BorderThickness="0"/>
                    <Button Content="Экспорт CSV" Click="ExportBtn_Click" 
                            Margin="5" Padding="15,8" Background="#0078d4" Foreground="White" BorderThickness="0"/>
                    <Button Content="Очистить" Click="ClearBtn_Click" 
                            Margin="5" Padding="15,8" Background="#d13438" Foreground="White" BorderThickness="0"/>
                </StackPanel>

                <!-- Индикаторы статуса -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                    <StackPanel Orientation="Horizontal" Margin="10,0">
                        <Ellipse x:Name="TempIndicator" Width="12" Height="12" Fill="Gray" Margin="0,0,5,0"/>
                        <TextBlock x:Name="Temp" Text="Температура" Foreground="#666" Margin="0,0,10,0"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="10,0">
                        <Ellipse x:Name="HumidityIndicator" Width="12" Height="12" Fill="Gray" Margin="0,0,5,0"/>
                        <TextBlock x:Name="Hum" Text="Влажность" Foreground="#666" Margin="0,0,10,0"/>
                    </StackPanel>

                </StackPanel>
            </Grid>
        </Border>
        <Button Content="☾" HorizontalAlignment="Left" Margin="562,10,0,0" Grid.Row="2" VerticalAlignment="Top" Height="30" Click="Button_Click" Width="26" Background="Black" Foreground="White" FontSize="18" Grid.Column="1"/>
        <Button Content="☀" HorizontalAlignment="Left" Margin="525,10,0,0" Grid.Row="2" VerticalAlignment="Top" Width="25" Height="30" Foreground="#FFDACA20" Background="Black" Grid.Column="1" Click="Button_Click_1"/>
    </Grid>
</Window>